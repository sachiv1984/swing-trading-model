# Lessons Learnt — Position Sizing Calculator

**Feature:** 3.2 — Position Sizing Calculator
**Pre-alignment completed:** 2026-02-19
**Feature shipped:** 2026-02-20
**Reviewed by:** PMO Lead
**Date filed:** 2026-02-21

---

## What worked well

- All six pre-alignment decisions closed at the meeting with no deferrals and no reopeners. The decisions record was committed before Phase 2 spec work began and held throughout.
- QA review passed first time. Acceptance criteria were fully derivable from the canonical specs as committed. No findings required rework.
- Scope document was produced cleanly with all 11 pre-implementation checklist items confirmed complete. The out-of-scope section was comprehensive and pre-empted any boundary ambiguity during implementation.
- `openapi.yaml` was reviewed inline with the API contract changes in the same PR. Governance rule satisfied without prompt.
- Director of Quality sign-off was granted the day after the scope document was committed, indicating the implementation handoff was well-prepared.

---

## What created friction

### 1. Settings field dependency missed by readiness audit
**Phase:** Section 1 — Readiness Audit / Section 6 — Effort Estimate
**What happened:** The `default_risk_percent` settings field was not in the original roadmap scope. It was discovered during the pre-alignment meeting when the question of widget pre-population arose. This triggered a new database migration, updates to `settings_endpoints.md`, `settings.md`, `data_model.md`, and `api_dependencies.md` — none of which were in the original estimate. The effort estimate revised from 1–2 days to 2–3 days as a result.
**Root cause:** The readiness audit had no explicit check for settings field dependencies. Features that read or write to the settings table were not treated as a distinct audit category, so the connection between the widget's pre-population behaviour and the settings model was not surfaced before the meeting.
**Impact:** Scope and estimate changed at the meeting rather than before it. Delivered cleanly, but the discovery should have happened earlier.

### 2. No post-ship document closure process
**Phase:** Post-delivery (no template exists)
**What happened:** After v1.6 shipped, seven documents required updating to reflect the closed state: `roadmap.md`, `changelog.md`, `backlog.md`, `scope--3.2-position-sizing-calculator.md`, `3.2-position-sizing-calculator.md`, `validation_system.md`, and `Specs_Index.md`. There was no checklist or template to drive this sweep — it was reconstructed by audit, with the risk that documents would be missed or updated inconsistently.
**Root cause:** The pre-alignment process has no defined post-ship phase. The process ends when implementation is declared open; there is no corresponding process for closing the documentation loop when the feature ships.
**Impact:** In this case all documents were identified and updated correctly, but only because the audit was run deliberately. Without a template, a future ship could leave stale planning documents, unclosed backlog items, or a changelog entry that never gets written.

### 3. Concurrent BLG-TECH-02 contract work interleaved with feature delivery
**Phase:** Section 3 — Parallel Spec Delivery
**What happened:** A5/A6 actions (the `analytics_endpoints.md` severity contract for BLG-TECH-02) were delivered in the same session as the Position Sizing Calculator spec work. Both were correct and governed properly, but the interleaving required care to keep action tracking clean across two separate features simultaneously.
**Root cause:** BLG-TECH-01 was a quality gate for v1.6, making it a dependency of the same release as 3.2. This created legitimate concurrent work but the pre-alignment run template has no guidance for managing concurrent feature actions within a single session.
**Impact:** Minor — no failures or incorrect commits. But the risk of cross-contamination in action tracking increases when two features are in flight simultaneously.

---

## Process improvements actioned

### 1. Settings field dependency check added to `pre_alignment_readiness.md`
**Template updated:** `docs/team_skills/pmo/processess/pre_alignment_readiness.md`
**Version bump:** 1.0 → 1.1
**Change:** Added a new checklist item to Section 1 (Data Model Readiness): "Does the feature read from or write to the settings table? If yes, confirm all required fields exist in `data_model.md` and `settings_endpoints.md`, and that the Settings page UI spec is current." This ensures settings dependencies are identified before the meeting rather than during it.

### 2. Post-ship document closure template created
**New file:** `docs/team_skills/pmo/processess/post_ship_closure.md`
**Version:** 1.0
**Change:** New process template defining the document sweep required when a feature ships. Covers: changelog entry, backlog item closure, scope and decisions document supersession, roadmap status update, supporting document currency check, and Specs Index open items review. Should be run by the PMO Lead when the Product Owner confirms ship sign-off.

---

## New skills or templates created

- `docs/team_skills/pmo/processess/post_ship_closure.md` (v1.0) — new template for post-ship document closure sweep

---

## Outstanding actions

| Action | Owner | Target |
|--------|-------|--------|
| Concurrent feature action tracking guidance — add a note to `pre_alignment_run.md` on how to manage action tables when two features are in flight in the same session | PMO Lead | Before v1.6.1 pre-alignment opens |
| Settings canonical spec — create the settings model canonical document (Specs Index §6.1) | Head of Specs Team | Before v1.6.1 pre-alignment opens |
| Error response standard — define canonical error shapes (Specs Index §6.2) | API Contracts & Documentation Owner | Before v1.6.1 exits |
| `validation_system.md` owner field — update to named role (Specs Index §7.1) | Infrastructure & Operations Documentation Owner | Next document update |