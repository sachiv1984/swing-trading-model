# Production Strategy – Momentum Trading System

**Owner:** Strategy Rules & System Intent Owner  
**Status:** Canonical  
**Version:** 1.2  
**Last updated:** 18 February 2026  
**Applies to:** Production backtests, live system, and documentation  

---

## Change log

- **1.2 (18 February 2026):** Added canonical rules for the Position Sizing Calculator (Section 4.1), including risk basis, stop-distance definition, rounding, FX handling, and cash feasibility gating. No changes to stop-loss or exit logic.
- **1.1 (18 February 2026):** Expanded system boundaries and design rationale. No behaviour changes.
- **1.0 (February 2026):** Initial canonical version.

---

## 1. Purpose

This document defines the authoritative production strategy for the Momentum Trading System.

It acts as a behavioural contract between:
- strategy intent,
- system implementation, and
- backtests and reported performance.

If a behaviour can affect trading outcomes, it must be specified here. If there is a conflict between this document and the code, UI, analytics, or user interpretation, this document prevails.

---

## 2. Strategy intent (non-negotiable)

The strategy is designed to:
- capture medium- to long-term momentum trends,
- avoid premature exits caused by early volatility,
- give losing trades time to resolve,
- defend profits aggressively once momentum is confirmed, and
- enforce asymmetric risk: losses are tolerated; gains are defended.

These principles are stable over time.

---

## 3. Human-in-the-loop execution model

- Entries and exits are executed manually by the user.
- Exits generated by the system are recommendations, not automatic orders.
- The system provides decision support only and does not execute trades.

This is an intentional design constraint.

---

## 4. Position entry rules

Positions are entered manually via the web interface.

**Required at entry:**
- ticker symbol,
- entry date,
- entry price,
- number of shares (fractional supported), and
- ATR value (used to calculate the stop).

Fees are applied automatically based on market (UK / US).

---

## 4.1 Position Sizing Calculator (decision support) — canonical rules

This section defines the canonical and deterministic behaviour for the Position Sizing Calculator used during position entry.

- The calculator proposes a share quantity only.
- It does not change entry, stop, or exit rules.
- All sizing calculations are performed on the backend and are authoritative.

### 4.1.1 Definitions

**Stop price**  
The price level at which a position should be exited to limit loss. It is stored and enforced in the instrument’s native currency.

**Entry price**  
The user-entered entry price in the instrument’s native currency.

**Stop distance**  
The difference between Entry price and Stop price, in the instrument’s native currency.

```text
StopDistance = EntryPrice - StopPrice
```

**Portfolio value**  
The total portfolio value in the portfolio base currency, as stored by the backend.

**Available cash**  
Cash available to allocate to a new position, as stored by the backend.

### 4.1.2 Risk basis (canonical)

Risk is budgeted at the portfolio level.

```text
RiskAmount = PortfolioValue * RiskPercent
```

Available cash is an execution feasibility constraint and must not be used as the risk basis.

### 4.1.3 Share calculation (canonical)

```text
RawShares = RiskAmount / StopDistance
```

**Rounding**
- Shares are rounded to **2 decimal places**.
- Rounding is conservative to avoid exceeding the intended risk.

```text
SuggestedShares = floor(RawShares, 2dp)
```

### 4.1.4 Validity rules (deterministic constraints)

The sizing result is invalid if any of the following are true:
- `RiskPercent <= 0`
- `PortfolioValue <= 0`
- `EntryPrice <= 0`
- `StopPrice <= 0`
- `StopDistance <= 0` (including `StopPrice >= EntryPrice`)

When invalid:
- no `SuggestedShares` is applied, and
- a deterministic invalid reason code must be returned.

### 4.1.5 Currency and FX handling (canonical)

- Entry price and Stop price are in the instrument’s native currency.
- Portfolio value and Available cash may be in the portfolio base currency.

If conversion is required:
- the system uses an effective FX rate,
- the default is system-provided live FX, and
- a user-provided FX rate overrides live FX.

The FX rate used must be returned in the sizing response for auditability.

### 4.1.6 Cash constraint (execution feasibility gate)

The calculator must not apply a share count that exceeds Available cash.

```text
EstimatedCost = (SuggestedShares * EntryPrice) + EstimatedFees
```

If:

```text
EstimatedCost > AvailableCash
```

Then:

```text
Result = INSUFFICIENT_CASH
```

In this case:
- shares must not be auto-filled, and
- the result may include `MaxAffordableShares` for UI messaging.

### 4.1.7 UI interaction requirement

- The Position Sizing Calculator is enabled via a toggle in the Position Entry modal.
- When enabled, the backend computes `SuggestedShares`.
- The UI auto-fills Shares only when:
  - the result is valid, and
  - `EstimatedCost <= AvailableCash`.

---

## 5. Initial stop calculation

At entry, an initial protective stop is calculated:

```text
InitialStop = EntryPrice - (InitialATRMultiplier * ATR)
```

Rules:
- The stop exists immediately.
- The stop is stored and tracked from day one.
- The stop is not enforced during the grace period.

Purpose:
- to make downside risk visible,
- to anchor trailing stop logic, and
- to reduce reactive decision-making.

---

## 6. Grace period

### 6.1 Definition

A fixed grace period applies to all new positions.

### 6.2 Current production configuration

- **Grace period length:** 10 calendar days (days 0–9 inclusive)

### 6.3 Behaviour during the grace period

- Stop-loss enforcement is disabled.
- The stop price is calculated and stored.
- No stop-based exit recommendation may be generated.
- Manual exit is always permitted.

### 6.4 Rationale

The grace period reduces the likelihood of exits caused by normal post-entry volatility rather than a breakdown of the trade thesis.

---

## 7. Trailing stop-loss framework (post-grace)

After the grace period, the position enters active risk management.

### 7.1 ATR framework

- **ATR period:** 14 days (rolling)
- ATR is recalculated daily.

### 7.2 Profit-aware stop logic

**Losing or breakeven positions**
```text
Stop = CurrentPrice - (InitialATRMultiplier * ATR)
```
- Wide stop intended to allow recovery.
- Reduces noise-driven exits.

**Profitable positions**
```text
Stop = CurrentPrice - (ProfitATRMultiplier * ATR)
```
- Tight trailing stop intended to lock in gains.
- Reduces drawdowns from winning positions.

### 7.3 Stop movement rule (hard constraint)

```text
UpdatedStop = max(CurrentStop, NewlyCalculatedStop)
```

Stops must never move downwards. Once tightened, a stop must not be loosened. This rule is absolute.

---

## 8. Exit conditions

A position may exit under exactly three conditions.

### 8.1 Stop-loss trigger

- Active only after the grace period.
- Triggered when the market price breaches the trailing stop.
- Exit is recommended and requires manual confirmation.

### 8.2 Market risk-off override

- Positions are exited when the relevant market enters a risk-off regime.
- The regime is defined by the 200-day moving average of the relevant index.
- This applies regardless of stop position.

### 8.3 Manual exit

- User-initiated.
- Available at any time.

---

## 9. Position states

Each position exists in exactly one state at any time.

| State | Definition |
|---|---|
| `GRACE` | Days 0–9, stop inactive |
| `LOSING` | Post-grace, P&L ≤ 0, wide stop |
| `PROFITABLE` | Post-grace, P&L > 0, tight stop |
| `EXITED` | Position closed |

States are mutually exclusive and deterministic.

---

## 10. Risk management summary

**Position-level**
- Fixed grace period.
- Wide stops while losing.
- Tight stops once profitable.
- Stops only tighten.

**Portfolio-level**
- Market regime override.
- Currency-aware P&L.
- Cash-flow-adjusted performance tracking.

---

## 11. Current production parameters

- **Grace period:** 10 days  
- **Initial / losing stop multiplier:** 5 × ATR  
- **Profitable stop multiplier:** 2 × ATR  
- **ATR period:** 14 days  

These parameters must be consistent across production backtests, live system logic, and reported performance metrics.

---

## 12. Parameter governance

The values above are parameters, not immutable rules. They describe how the strategy currently expresses its intent.

### 12.1 Stable elements

- A grace period exists.
- Losses and profits are treated asymmetrically.
- Profits are defended once momentum is confirmed.
- Stops do not loosen.

### 12.2 Elements that may change

- Grace period length.
- ATR multipliers.
- ATR lookback period.

### 12.3 Change control requirements

Any parameter change must:
- be explicitly documented,
- be versioned at the strategy level,
- state the rationale and expected impact,
- acknowledge loss of direct comparability with prior results, and
- be applied consistently across backtests, live logic, and documentation.

Until a change is made, the listed parameters define canonical production behaviour.

---

## 13. System boundaries

### 13.1 This system is

- A deterministic decision-support engine.
- A risk-managed momentum framework.
- A single, explicit, human-designed strategy.
- Human-in-the-loop by design.

### 13.2 This system is not

- An automated trading bot.
- A broker execution engine.
- A discretionary or adaptive rule system.
- A multi-strategy or configurable strategy platform.
- A machine-learning or AI-driven prediction system.
- An options or futures trading system.
- A real-time streaming or execution system.

### 13.3 Design boundary rationale

Human-in-the-loop execution is a design principle, not a limitation. Gap risk monitoring is excluded by design because the system operates on a daily decision cadence. The strategy is fixed and explicit; adaptability is not a goal.

---

## 14. Authority statement

This document is the single source of truth for production strategy behaviour.

If a discrepancy exists between code, UI behaviour, analytics, or user interpretation, this document prevails.

**Guiding principle:** If a rule can change outcomes, it must be explicit, intentional, and owned.
